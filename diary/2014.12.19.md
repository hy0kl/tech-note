# 问题记录

```
最近一周左右的项目开发,遇到不少灵异现象,为了忘却的记念,特此记录一下.
首先是环境不一致.
开发环境是 php5.5.14 + nginx1.6.0 + mysql5.6.19
线上环境是 php5.3.28 + apache2.2.27 _ mysql5.1
以下问题只出现在线上环境,开发环境一切正常.

第一个问题是 php 无法从 $_REQUEST 中取得 $_COOKIE 的值.
和手册(http://php.net/manual/zh/reserved.variables.request.php)上表现的不一致.
导致我们封装的方法取不到 $_COOKIE 里面的值,从而依赖 cookie 的逻辑全部失效.

第二个问题,封装的一个 curl 工具,线上却无法从数据接口取数据.
通过线上测试脚本发现,仅使用 curl_init(), curl_exec(),其他什么可选参数都不设定,却可以正常取回数组.
将 curl 工具简化后解决,但真心没查出来是哪个参数影响了行为.

第三个问题,简单封装的轻量级单例模式的 pdo db 类,线上环境在执行两个特定页面时执行 sql 失败.
但将 sql 打印出来,在命令行下执行时,完全正确.采用 try/catch 时也没能捕获异常,但 dump 的结果总在第三条语句处为 false,而且之后所有的 sql 语句均不会有正确执行结果.
实在找不到合理的解释,只好尝试去掉 db 的单例模式,改为直连,没想到居然好使.

只能说环境不一致的开发模式,尤其是线上环境多落后的情况,真心是在挖坑.
```
